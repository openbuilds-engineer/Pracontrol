var style = `
:host {
  position: absolute;
  display: block;
  z-index: 1;
  
  background-color: Highlight;
  bottom: 2rem; right: 1rem; max-width: calc(100% - 2rem);
  padding: 0em .2em; border-radius: .25em;
}

:host:empty { display: none; }

::content msg {
  display: block;
}
`

module.exports = class Msg extends WebComponentAbstract {
  init() {
    this.renderCss(style)
    
    // error reporting
    self.on('error', e => this.msg((e.message && e.message.replace(/^[^:]*:/, '') || e.detail.message)))
    self.on('unhandledrejection', e => this.msg(e.reason.message))
    
    defineEvent('self.msg', 'New status message', 'Core', `{ msg: '' }`)
    self.on('msg', e => this.msg(e.detail))
    
    // append to DOM
    document.body.append(this)
  }
  
  msg(msg) {
    var el = this.new('msg', { textContent: msg })
    setTimeout(() => el.remove(), 3000)
  }
}
