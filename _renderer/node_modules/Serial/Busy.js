module.exports = class SerialBusy extends WebComponentAbstract {
  init() {
    defineEvent('deviceReady', 'Device is ready, listen only', 'Device')
    defineEvent('deviceBusy', 'Device is busy, listen only', 'Device')
    
    self.on('connected', e => self.emit('serialDirectWrite', { data: 'G4\n' }))
    
    self.on('serialDirectWrite', e => self.emit('deviceBusy'))
    self.on('serialData', e => e.detail.data.substr(0, 2) == 'ok' && self.emit('deviceReady'))
    
    self.on('deviceReset', e => self.emit('deviceReady'))
  }
}
